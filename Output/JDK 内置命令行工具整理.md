---
type: permanent
---
# ğŸŒ æ ¸å¿ƒè§‚ç‚¹

å¾ˆå¤šæƒ…å†µä¸‹, JVM è¿è¡Œç¯å¢ƒä¸­å¹¶æ²¡æœ‰è¶æ‰‹çš„å·¥å…·, æ‰€ä»¥æŒæ¡åŸºæœ¬çš„å†…ç½®å·¥å…·æ˜¯ä¸€é¡¹åŸºæœ¬åŠŸ.

---

# ğŸ”– è¯¦ç»†è§£é‡Š

## 1	JDK å†…ç½®å¼€å‘å·¥å…·

| å·¥å…·         | ç®€ä»‹                                                                          |
| :--------- | :-------------------------------------------------------------------------- |
| java       | Java åº”ç”¨çš„å¯åŠ¨ç¨‹åº                                                                |
| javac      | JDK å†…ç½®çš„ç¼–è¯‘å·¥å…·                                                                 |
| javap      | åç¼–è¯‘ class æ–‡ä»¶çš„å·¥å…·                                                             |
| javadoc    | æ ¹æ® Java ä»£ç å’Œæ ‡å‡†æ³¨é‡Š, è‡ªåŠ¨ç”Ÿæˆç›¸å…³çš„ API è¯´æ˜æ–‡æ¡£                                           |
| javah      | JNI å¼€å‘æ—¶, æ ¹æ® Java ä»£ç ç”Ÿæˆéœ€è¦çš„ . h æ–‡ä»¶.                                            |
| extcheck   | æ£€æŸ¥æŸä¸ª jar æ–‡ä»¶å’Œè¿è¡Œæ—¶æ‰©å±• jar æœ‰æ²¡æœ‰ç‰ˆæœ¬å†²çª, å¾ˆå°‘ä½¿ç”¨                                         |
| jdb        | Java Debugger å¯ä»¥è°ƒè¯•æœ¬åœ°å’Œè¿œç«¯ç¨‹åº, å±äº JPDA ä¸­çš„ä¸€ä¸ª Demo å®ç°, ä¾›å…¶ä»–è°ƒè¯•å™¨å‚è€ƒ. å¼€å‘æ—¶å¾ˆå°‘ä½¿ç”¨          |
| jdeps      | æ¢æµ‹ class æˆ– jar åŒ…éœ€è¦çš„ä¾èµ–                                                       |
| jar        | æ‰“åŒ…å·¥å…·, å¯ä»¥å°†æ–‡ä»¶å’Œç›®å½•æ‰“åŒ…æˆä¸º . jar æ–‡ä»¶;. jar æ–‡ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ zip æ–‡ä»¶, åªæ˜¯åç¼€ä¸åŒ. ä½¿ç”¨æ—¶æŒ‰é¡ºåºå¯¹åº”å¥½é€‰é¡¹å’Œå‚æ•°å³å¯. |
| keytool    | å®‰å…¨è¯ä¹¦å’Œå¯†é’¥çš„ç®¡ç†å·¥å…·(æ”¯æŒç”Ÿæˆ, å¯¼å…¥, å¯¼å‡ºç­‰æ“ä½œ)                                               |
| jarsigner  | jar æ–‡ä»¶ç­¾åå’ŒéªŒè¯å·¥å…·                                                               |
| policytool | å®é™…ä¸Šè¿™æ˜¯ä¸€æ¬¾å›¾å½¢ç•Œé¢å·¥å…·, ç®¡ç†æœ¬æœºçš„ Java å®‰å…¨ç­–ç•¥                                              |

## 2	å‘½ä»¤è¡Œè¯Šæ–­å’Œåˆ†æå·¥å…·

ç”¨äºå¿«é€ŸæŸ¥çœ‹ JVM å®ä¾‹çš„å†…éƒ¨æƒ…å†µ.

### 2.1	JPS å·¥å…·

ç”¨äºå±•ç¤º**å½“å‰ç”¨æˆ·å¯è§**çš„ Java **è¿›ç¨‹**ä¿¡æ¯.

```bash
usage: jps [-help]
       jps [-q] [-mlvV] [<hostid>]
Definitions:
    <hostid>:      <hostname>[:<port>]
```

å¸¸ç”¨çš„å‚æ•°æ˜¯ -v, ç”¨äºæ˜¾ç¤ºä¼ é€’ç»™ JVM çš„å¯åŠ¨å‚æ•°.

```bash
15883 Jps -Dapplication.home=/usr/local/jdk1.8.0_74 -Xms8m
6446 Jstatd -Dapplication.home=/usr/local/jdk1.8.0_74 -Xms8m
        -Djava.security.policy=/etc/java/jstatd.all.policy
32383 Bootstrap -Xmx4096m -XX:+UseG1GC -verbose:gc
        -XX:+PrintGCDateStamps -XX:+PrintGCDetails
        -Xloggc:/xxx-tomcat/logs/gc.log
        -Dcatalina.base=/xxx-tomcat -Dcatalina.home=/data/tomcat
```

æœ€é‡è¦çš„ä¿¡æ¯æ˜¯ç¬¬ä¸€åˆ—çš„ PID.

å…¶ä»–çš„ä¸å¸¸ç”¨å‚æ•°:

- -q: åªæ˜¾ç¤ºè¿›ç¨‹å·.
	
- -m: æ˜¾ç¤ºä¼ ç»™ main æ–¹æ³•çš„å‚æ•°ä¿¡æ¯
	
- -l: æ˜¾ç¤ºå¯åŠ¨ class çš„å®Œæ•´ç±»å, æˆ–è€…å¯åŠ¨ jar çš„å®Œæ•´è·¯å¾„
	
- -V: å¤§å†™çš„ V, è¿™ä¸ªå‚æ•°æœ‰é—®é¢˜, ç›¸å½“äºæ²¡ä¼ ä¸€æ ·. å®˜æ–¹è¯´çš„è·Ÿ -q å·®ä¸å¤š.
	
- \<hostid>: éƒ¨åˆ†æ˜¯è¿œç¨‹ä¸»æœºçš„æ ‡è¯†ç¬¦, éœ€è¦è¿œç¨‹ä¸»æœºå¯åŠ¨ jstatd æœåŠ¡å™¨æ”¯æŒ.

### 2.2	jstat å·¥å…·

ç”¨æ¥ç›‘æ§ JVM å†…ç½®çš„å„ç§ç»Ÿè®¡ä¿¡æ¯, ä¸»è¦æ˜¯**å†…å­˜**å’Œ **GC** ç›¸å…³çš„ä¿¡æ¯.

```bash
Usage: jstat -help | -options
       jstat -<option> [-t] [-h<lines>] <vmid> [<interval> [<count>]]

Definitions:
  <option>      å¯ç”¨çš„é€‰é¡¹ï¼ŒæŸ¥çœ‹è¯¦æƒ…è¯·ä½¿ç”¨ -options
  <vmid>        è™šæ‹Ÿæœºæ ‡è¯†ç¬¦ï¼Œæ ¼å¼ï¼š<lvmid>[@<hostname>[:<port>]]
  <lines>       æ ‡é¢˜è¡Œé—´éš”çš„é¢‘ç‡.
  <interval>    é‡‡æ ·å‘¨æœŸï¼Œ<n>["ms"|"s"]ï¼Œé»˜è®¤å•ä½æ˜¯æ¯«ç§’ "ms"
  <count>       é‡‡ç”¨æ€»æ¬¡æ•°
  -J<flag>      ä¼ ç»™jstatåº•å±‚JVMçš„ <flag> å‚æ•°
```

æ”¯æŒçš„é€‰é¡¹:

- -class: ç±»åŠ è½½(Class loader)ä¿¡æ¯ç»Ÿè®¡.
	
- -compiler: JIT å³æ—¶ç¼–è¯‘å™¨ç›¸å…³çš„ç»Ÿè®¡ä¿¡æ¯.
	
- -gc: GC ç›¸å…³çš„å †å†…å­˜ä¿¡æ¯, ç”¨æ³•: jstat -gc -h 10 -t 864 1s 20.
	
- -gccapacity: å„ä¸ªå†…å­˜æ± åˆ†ä»£ç©ºé—´çš„å®¹é‡.
	
- -gccause: çœ‹ä¸Šæ¬¡ GC, æœ¬æ¬¡ GC(å¦‚æœæ­£åœ¨ GC ä¸­)çš„åŸå› , å…¶ä»–è¾“å‡ºå’Œ -gcutil é€‰é¡¹ä¸€è‡´.
	
- -gcnew: å¹´è½»ä»£çš„ç»Ÿè®¡ä¿¡æ¯(New = Young = Eden + S0 + S1).
	
- -gcnewcapacity: å¹´è½»ä»£ç©ºé—´å¤§å°ç»Ÿè®¡.
	
- -gcold: è€å¹´ä»£å’Œå…ƒæ•°æ®åŒºçš„è¡Œä¸ºç»Ÿè®¡.
	
- -gcoldcapacity: old ç©ºé—´å¤§å°ç»Ÿè®¡.
	
- -gcmetacapacity: meta åŒºå¤§å°ç»Ÿè®¡.
	
- -gcutil: GC ç›¸å…³åŒºåŸŸçš„ä½¿ç”¨ç‡(utilization)ç»Ÿè®¡.
	
- -printcompilation:æ‰“å° JVM ç¼–è¯‘ç»Ÿè®¡ä¿¡æ¯.

### 2.3	jmap å·¥å…·

ä¸»è¦ç”¨æ¥ dump å †å†…å­˜.

```bash
Usage:
    jmap [option] <pid>
        (è¿æ¥åˆ°æœ¬åœ°è¿›ç¨‹)
    jmap [option] <executable <core>
        (è¿æ¥åˆ° core file)
    jmap [option] [server_id@]<remote-IP-hostname>
        (è¿æ¥åˆ°è¿œç¨‹ debug æœåŠ¡)

where <option> is one of:
    <none>               ç­‰åŒäº Solaris çš„ pmap å‘½ä»¤
    -heap                æ‰“å° Java å †å†…å­˜æ±‡æ€»ä¿¡æ¯
    -histo[:live]        æ‰“å° Java å †å†…å­˜å¯¹è±¡çš„ç›´æ–¹å›¾ç»Ÿè®¡ä¿¡æ¯
                         å¦‚æœæŒ‡å®šäº† "live" é€‰é¡¹åˆ™åªç»Ÿè®¡å­˜æ´»å¯¹è±¡ï¼Œå¼ºåˆ¶è§¦å‘ä¸€æ¬¡ GC
    -clstats             æ‰“å° class loader ç»Ÿè®¡ä¿¡æ¯
    -finalizerinfo       æ‰“å°ç­‰å¾… finalization çš„å¯¹è±¡ä¿¡æ¯
    -dump:<dump-options> å°†å †å†…å­˜ dump ä¸º hprof äºŒè¿›åˆ¶æ ¼å¼
                         æ”¯æŒçš„ dump-optionsï¼š
                           live         åª dump å­˜æ´»å¯¹è±¡ï¼Œä¸æŒ‡å®šåˆ™å¯¼å‡ºå…¨éƒ¨ã€‚
                           format=b     äºŒè¿›åˆ¶æ ¼å¼(binary format)
                           file=<file>  å¯¼å‡ºæ–‡ä»¶çš„è·¯å¾„
                         ç¤ºä¾‹ï¼šjmap -dump:live,format=b,file=heap.bin <pid>
    -F                   å¼ºåˆ¶å¯¼å‡ºï¼Œè‹¥ jmap è¢« hang ä½ä¸å“åº”ï¼Œå¯æ–­å¼€åä½¿ç”¨æ­¤é€‰é¡¹ã€‚
                         å…¶ä¸­ "live" é€‰é¡¹ä¸æ”¯æŒå¼ºåˆ¶å¯¼å‡ºã€‚
    -h | -help           to print this help message
    -J<flag>             to pass <flag> directly to the runtime system
```

å¸¸ç”¨é€‰é¡¹æœ‰:

- -heap: æ‰“å°å †å†…å­˜ (/å†…å­˜æ± ) çš„é…ç½®å’Œä½¿ç”¨ä¿¡æ¯;
	
- -histo: çœ‹å“ªäº›ç±»å ç”¨çš„ç©ºé—´æœ€å¤š, ç›´æ–¹å›¾;
	
- -dump:format=b,file=xxxx.hprof: Dump å †å†…å­˜.





---

# ğŸ“š å‚è€ƒå†…å®¹

