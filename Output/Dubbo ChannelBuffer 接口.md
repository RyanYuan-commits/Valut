---
type: permanent
---
# ğŸŒ æ ¸å¿ƒè§‚ç‚¹

ä¸€ä¸ªéšæœºä¸”å¯é¡ºåºè®¿é—®çš„é›¶ä¸ªæˆ–å¤šä¸ªå­—èŠ‚ (8ä½ç»„) åºåˆ—, è¯¥æ¥å£ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªåŸºæœ¬å­—èŠ‚æ•°ç»„  `byte[]` å’Œ `ByteBuffer` æä¾›äº†æŠ½è±¡è§†å›¾.

---

# ğŸ”– è¯¦ç»†è§£é‡Š

å»ºè®®ä½¿ç”¨ ChannelBuffers ä¸­çš„è¾…åŠ©æ–¹æ³•æ¥åˆ›å»ºæ–°ç¼“å†²åŒº, è€Œä¸æ˜¯è°ƒç”¨å•ä¸ªå®ç°çš„æ„é€ å‡½æ•°.

éšæœºè®¿é—®ç´¢å¼•: ä½¿ç”¨ä» 0 å¼€å§‹çš„ç´¢å¼•.


```
 * <h3>é¡ºåºè®¿é—®ç´¢å¼•</h3>
 * <p/>
 * {@link ChannelBuffer} æä¾›äº†ä¸¤ä¸ªæŒ‡é’ˆå˜é‡æ¥æ”¯æŒé¡ºåºè¯»å†™æ“ä½œ - åˆ†åˆ«æ˜¯ç”¨äºè¯»æ“ä½œçš„ {@link #readerIndex() readerIndex}
 * å’Œç”¨äºå†™æ“ä½œçš„ {@link #writerIndex() writerIndex}.
 * ä¸‹å›¾å±•ç¤ºäº†ç¼“å†²åŒºæ˜¯å¦‚ä½•è¢«è¿™ä¸¤ä¸ªæŒ‡é’ˆåˆ†å‰²æˆä¸‰ä¸ªåŒºåŸŸçš„:
 * <p/>
 * <pre>
 * +-------------------+------------------+------------------+
 * | discardable bytes | readable bytes | writable bytes |
 * | (å·²ä¸¢å¼ƒå­—èŠ‚) | (å¯è¯»å­—èŠ‚) | (å¯å†™å­—èŠ‚) |
 * +-------------------+------------------+------------------+
 * | | | |
 * 0 <= readerIndex <= writerIndex <= capacity
 * </pre>
 * <p/>
 * <h4>å¯è¯»å­—èŠ‚(å®é™…å†…å®¹)</h4>
 * <p/>
 * è¯¥æ®µå­˜å‚¨å®é™…æ•°æ®. ä»»ä½•åç§°ä»¥ {@code read} æˆ– {@code skip} å¼€å¤´çš„æ“ä½œéƒ½ä¼šè·å–æˆ–è·³è¿‡å½“å‰ {@link #readerIndex() readerIndex} å¤„çš„æ•°æ®,
 * å¹¶å°†è¯¥ç´¢å¼•å¢åŠ è¯»å–çš„å­—èŠ‚æ•°. å¦‚æœè¯»æ“ä½œçš„å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ª {@link ChannelBuffer} ä¸”æœªæŒ‡å®šç›®æ ‡ç´¢å¼•, åˆ™æŒ‡å®šç¼“å†²åŒºçš„ {@link #readerIndex() readerIndex} ä¹Ÿä¼šä¸€åŒå¢åŠ .
 * <p/>
 * å¦‚æœå‰©ä½™å†…å®¹ä¸è¶³, å°†æŠ›å‡º {@link IndexOutOfBoundsException}. æ–°åˆ†é…, åŒ…è£…æˆ–å¤åˆ¶çš„ç¼“å†²åŒº, å…¶ {@link #readerIndex() readerIndex} çš„é»˜è®¤å€¼ä¸º {@code 0}.
 * <p/>
 * <pre>
 * // éå†ç¼“å†²åŒºçš„å¯è¯»å­—èŠ‚.
 * {@link ChannelBuffer} buffer = . . . ;
 * while (buffer. readable()) {
 * System. out. println(buffer. readByte());
 * }
 * </pre>
 * <p/>
 * <h4>å¯å†™å­—èŠ‚</h4>
 * <p/>
 * è¯¥æ®µæ˜¯ä¸€ä¸ªéœ€è¦å¡«å……çš„æœªå®šä¹‰ç©ºé—´. ä»»ä½•åç§°ä»¥ {@code write} ç»“å°¾çš„æ“ä½œéƒ½ä¼šåœ¨å½“å‰ {@link #writerIndex() writerIndex} å¤„å†™å…¥æ•°æ®,
 * å¹¶å°†è¯¥ç´¢å¼•å¢åŠ å†™å…¥çš„å­—èŠ‚æ•°. å¦‚æœå†™æ“ä½œçš„å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ª {@link ChannelBuffer} ä¸”æœªæŒ‡å®šæºç´¢å¼•, åˆ™æŒ‡å®šç¼“å†²åŒºçš„ {@link #readerIndex() readerIndex} ä¹Ÿä¼šä¸€åŒå¢åŠ .
 * <p/>
 * å¦‚æœå‰©ä½™å¯å†™å­—èŠ‚ä¸è¶³, å°†æŠ›å‡º {@link IndexOutOfBoundsException}. æ–°åˆ†é…ç¼“å†²åŒºçš„ {@link #writerIndex() writerIndex} é»˜è®¤å€¼ä¸º {@code 0}.
 * åŒ…è£…æˆ–å¤åˆ¶ç¼“å†²åŒºçš„ {@link #writerIndex() writerIndex} é»˜è®¤å€¼ä¸ºç¼“å†²åŒºçš„ {@link #capacity() capacity}.
 * <p/>
 * <pre>
 * // ç”¨éšæœºæ•´æ•°å¡«å……ç¼“å†²åŒºçš„å¯å†™å­—èŠ‚.
 * {@link ChannelBuffer} buffer = . . . ;
 * while (buffer. writableBytes() >= 4) {
 * buffer. writeInt(random. nextInt());
 * }
 * </pre>
 * <p/>
 * <h4>å¯ä¸¢å¼ƒå­—èŠ‚</h4>
 * <p/>
 * è¯¥æ®µåŒ…å«å·²ç»è¢«è¯»æ“ä½œè¯»å–è¿‡çš„å­—èŠ‚. æœ€åˆ, è¯¥æ®µçš„å¤§å°ä¸º {@code 0}, ä½†éšç€è¯»æ“ä½œçš„æ‰§è¡Œ, å…¶å¤§å°ä¼šå¢åŠ è‡³ {@link #writerIndex() writerIndex}.
 * å¯ä»¥é€šè¿‡è°ƒç”¨ {@link #discardReadBytes()} æ¥ä¸¢å¼ƒå·²è¯»å­—èŠ‚, ä»è€Œå›æ”¶æœªä½¿ç”¨çš„åŒºåŸŸ, å¦‚ä¸‹å›¾æ‰€ç¤º:
 * <p/>
 * <pre>
 * è°ƒç”¨ discardReadBytes() ä¹‹å‰
 *
 * +-------------------+------------------+------------------+
 * | discardable bytes | readable bytes | writable bytes |
 * +-------------------+------------------+------------------+
 * | | | |
 * 0 <= readerIndex <= writerIndex <= capacity
 *
 *
 * è°ƒç”¨ discardReadBytes() ä¹‹å
 *
 * +------------------+--------------------------------------+
 * | readable bytes | writable bytes (got more space) |
 * +------------------+--------------------------------------+
 * | | (è·å¾—äº†æ›´å¤šç©ºé—´) |
 * readerIndex (0) <= writerIndex (decreased) <= capacity
 * </pre>
 * <p/>
 * è¯·æ³¨æ„, è°ƒç”¨ {@link #discardReadBytes()} å, æ— æ³•ä¿è¯å¯å†™å­—èŠ‚çš„å†…å®¹. åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹, å¯å†™å­—èŠ‚ä¸ä¼šè¢«ç§»åŠ¨,
 * ç”šè‡³æ ¹æ®åº•å±‚ç¼“å†²åŒºçš„å®ç°, å¯èƒ½ä¼šå¡«å……å®Œå…¨ä¸åŒçš„æ•°æ®.
 * <p/>
 * <h4>æ¸…é™¤ç¼“å†²åŒºç´¢å¼•</h4>
 * <p/>
 * ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ {@link #clear()} å°† {@link #readerIndex() readerIndex} å’Œ {@link #writerIndex() writerIndex} éƒ½è®¾ç½®ä¸º {@code 0}.
 * è¿™ä¸ä¼šæ¸…é™¤ç¼“å†²åŒºå†…å®¹(ä¾‹å¦‚å¡«å…… {@code 0}), è€Œåªæ˜¯æ¸…é™¤è¿™ä¸¤ä¸ªæŒ‡é’ˆ.
 * å¦è¯·æ³¨æ„, æ­¤æ“ä½œçš„è¯­ä¹‰ä¸ {@link ByteBuffer#clear()} ä¸åŒ.
 * <p/>
 * <pre>
 * è°ƒç”¨ clear() ä¹‹å‰
 *
 * +-------------------+------------------+------------------+
 * | discardable bytes | readable bytes | writable bytes |
 * +-------------------+------------------+------------------+
 * | | | |
 * 0 <= readerIndex <= writerIndex <= capacity
 *
 *
 * è°ƒç”¨ clear() ä¹‹å
 *
 * +---------------------------------------------------------+
 * | writable bytes (got more space) |
 * +---------------------------------------------------------+
 * | (è·å¾—äº†æ›´å¤šç©ºé—´) |
 * 0 = readerIndex = writerIndex <= capacity
 * </pre>
 * <p/>
 * <h3>æ ‡è®°å’Œé‡ç½®</h3>
 * <p/>
 * æ¯ä¸ªç¼“å†²åŒºä¸­æœ‰ä¸¤ä¸ªæ ‡è®°ç´¢å¼•. ä¸€ä¸ªç”¨äºå­˜å‚¨ {@link #readerIndex() readerIndex}, å¦ä¸€ä¸ªç”¨äºå­˜å‚¨ {@link #writerIndex() writerIndex}.
 * ä½ æ€»æ˜¯å¯ä»¥é€šè¿‡è°ƒç”¨ reset æ–¹æ³•é‡æ–°å®šä½è¿™ä¸¤ä¸ªç´¢å¼•ä¹‹ä¸€. é™¤äº†æ²¡æœ‰ {@code readlimit} ä¹‹å¤–, å®ƒçš„å·¥ä½œæ–¹å¼ä¸ {@link InputStream} ä¸­çš„ mark å’Œ reset æ–¹æ³•ç±»ä¼¼.
 * <p/>
 * <h3>è½¬æ¢ä¸ºç°æœ‰çš„ JDK ç±»å‹</h3>
 * <p/>
 * <h4>å­—èŠ‚æ•°ç»„</h4>
 * <p/>
 * å¦‚æœ {@link ChannelBuffer} ç”±å­—èŠ‚æ•°ç»„(å³ {@code byte[]})æ”¯æŒ, ä½ å¯ä»¥é€šè¿‡ {@link #array()} æ–¹æ³•ç›´æ¥è®¿é—®å®ƒ.
 * è¦ç¡®å®šç¼“å†²åŒºæ˜¯å¦ç”±å­—èŠ‚æ•°ç»„æ”¯æŒ, åº”ä½¿ç”¨ {@link #hasArray()}.
 * <p/>
 * <h4>NIO ç¼“å†²åŒº</h4>
 * <p/>
 * å„ç§ {@link #toByteBuffer()} æ–¹æ³•å°† {@link ChannelBuffer} è½¬æ¢ä¸ºä¸€ä¸ªæˆ–å¤šä¸ª NIO ç¼“å†²åŒº.
 * è¿™äº›æ–¹æ³•å°½å¯èƒ½é¿å…ç¼“å†²åŒºåˆ†é…å’Œå†…å­˜å¤åˆ¶, ä½†ä¸ä¿è¯ä¸æ¶‰åŠå†…å­˜å¤åˆ¶.
 * <p/>
 * <h4>I/O æµ</h4>
 * <p/>
 * è¯·å‚è€ƒ {@link ChannelBufferInputStream} å’Œ {@link ChannelBufferOutputStream}.
```


---

# ğŸ“š å‚è€ƒå†…å®¹

